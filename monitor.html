<!DOCTYPE html>
<head>
<meta charset="UTF-8">
<title>パンダモニター画面</title>
</head>
<body onLoad='setTimeout("ajaxaccess()", 1000);'>
<script language="JavaScript">
<!--
  var reloadspan = 2000;

  //XMLHttpRequestオブジェクト生成
  function createHttpRequest(){

    //Win ie用
    if(window.ActiveXObject){
        try {
            //MSXML2以降用
            return new ActiveXObject("Msxml2.XMLHTTP");
        } catch (e) {
            try {
                //旧MSXML用
                return new ActiveXObject("Microsoft.XMLHTTP")
            } catch (e2) {
                return null;
            }
         }
    } else if(window.XMLHttpRequest){
        //Win ie以外のXMLHttpRequestオブジェクト実装ブラウザ用
        return new XMLHttpRequest();
    } else {
        return null;
    }
  }

  //ファイルにアクセスし受信内容を確認します
  function requestFile( data , method , fileName , async )
  {
    //XMLHttpRequestオブジェクト生成
    var httpoj = createHttpRequest();
    
    //open メソッド
    httpoj.open( method , fileName , async );
    
    //受信時に起動するイベント
    httpoj.onreadystatechange = function()
    { 
      //readyState値は4で受信完了
      if (httpoj.readyState==4)
      { 
        //コールバック
        on_loaded(httpoj);
      }
    }
    
    //send メソッド
    httpoj.send( data );
  }

  //コールバック関数 ( 受信時に実行されます )
  function on_loaded(oj)
  {
        //レスポンスを取得
        res  = oj.responseText;
        
        //テキストボックスに表示
        jsonobj = eval( "(" + res + ")" );

        document.getElementById("sensor1").value = jsonobj.sensor1;
        document.getElementById("sensor2").value = jsonobj.sensor2;
        document.getElementById("gyro1").value = jsonobj.gyro[0];
        document.getElementById("gyro2").value = jsonobj.gyro[1];
        document.getElementById("gyro3").value = jsonobj.gyro[2];
        if (jsonobj.comment) document.getElementById("comment").value = jsonobj.comment;

  }
 
  function ajaxaccess() {
  	requestFile( '' , 'GET', '/ajax.json' , true );
  	setTimeout("ajaxaccess()", reloadspan);
  }
//-->
</script>
<div style="float:left;">
<h1>センサー値</h1>
<div>
  sensor1:<input type="text" id="sensor1" size="10" value="0"><br>
  sensor2:<input type="text" id="sensor2" size="10" value="0"><br>
  gyro1:<input type="text" id="gyro1" size="10" value="0"><br>
  gyro2:<input type="text" id="gyro2" size="10" value="0"><br>
  gyro3:<input type="text" id="gyro3" size="10" value="0"><br>
  comment:<input type="text" id="comment" size="50" value="0"><br>
</div>
<h1>送信命令</h1>
<div>
  <form method="post" action="/post" target="postframe">
  pan:<input type="text" name="pan" size="10" value="0"><br>
  tilt:<input type="text" name="tilt" size="10" value="0"><br>
  talk:<textarea name="talk" cols=40 rows=3></textarea><br>
  <input type="submit" size="4" value="送信">
  <input type="reset" size="4" value="リセット">
  </form>
  <form method="post" action="/post" target="postframe">
    回数<input type="text" name="nod" size="10" value="0">
    <input type="submit" size="4" value="nod">
  </form>
  <form method="post" action="/post" target="postframe">
    回数<input type="text" name="shake" size="10" value="0">
    <input type="submit" size="4" value="shake">
  </form>
  <form method="post" action="/post" target="postframe">
    <input type="hidden" name="detach" size="10" value="0">
    <input type="submit" size="4" value="detach">
  </form>

</div>
<h2>送信応答</h2>
<div>
<iframe name="postframe">
</iframe>
</div>
</div>

<div style="float:left;">
<h1>可視化図</h1>
<div>
制作中



</div>
<h1>通信ログ</h1>
<div>
<textarea name="log" cols=50 rows=10></textarea>
</div>
</div>
</body>
</html>
