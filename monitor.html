
<script language="JavaScript">
<!--

  //XMLHttpRequestオブジェクト生成
  function createHttpRequest(){

    //Win ie用
    if(window.ActiveXObject){
        try {
            //MSXML2以降用
            return new ActiveXObject("Msxml2.XMLHTTP");
        } catch (e) {
            try {
                //旧MSXML用
                return new ActiveXObject("Microsoft.XMLHTTP")
            } catch (e2) {
                return null;
            }
         }
    } else if(window.XMLHttpRequest){
        //Win ie以外のXMLHttpRequestオブジェクト実装ブラウザ用
        return new XMLHttpRequest();
    } else {
        return null;
    }
  }

  //ファイルにアクセスし受信内容を確認します
  function requestFile( data , method , fileName , async )
  {
    //XMLHttpRequestオブジェクト生成
    var httpoj = createHttpRequest();
    
    //open メソッド
    httpoj.open( method , fileName , async );
    
    //受信時に起動するイベント
    httpoj.onreadystatechange = function()
    { 
      //readyState値は4で受信完了
      if (httpoj.readyState==4)
      { 
        //コールバック
        on_loaded(httpoj);
      }
    }
    
    //send メソッド
    httpoj.send( data );
  }

  //コールバック関数 ( 受信時に実行されます )
  function on_loaded(oj)
  {
        //レスポンスを取得
        res  = oj.responseText;
        
        //テキストボックスに表示
        jsonobj = eval( "(" + res + ")" );

        document.getElementById("sensor1").value = jsonobj.sensor1;
        document.getElementById("sensor2").value = jsonobj.sensor2;
  }
  
//-->
</script>
<form>
  <input type    = "button"
         value   = "ajax.jsonをリクエスト"
         onclick = "requestFile( '' , 'GET', '/ajax.json' , true )"><br>
  sensor1:<input type="text" id="sensor1" size="10" value="0"><br>
  sensor2:<input type="text" id="sensor2" size="10" value="0"><br>
  </form>
<br>
  <form method="post" action="/post" target="postframe">
  pan:<input type="text" name="pan" size="10" value="0"><br>
  tilt:<input type="text" name="tilt" size="10" value="0"><br>
  talk:<textarea name="talk" cols=40 rows=4></textarea>
  <input type="submit" size="4" value="送信">
  </form>
<iframe name="postframe">
</iframe>
